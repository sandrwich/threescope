<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Threescope</title>
  <link rel="icon" type="image/png" href="/textures/ui/sat_icon.png">
  <meta name="theme-color" content="#101010">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="/textures/icons/icon-192.png">
<style>
    @font-face {
      font-family: 'Overpass Mono';
      src: url('/textures/ui/overpass-mono.ttf') format('truetype');
      font-weight: 400;
      font-display: swap;
    }

    :root {
      color-scheme: dark;
      --bg: #000000;
      --ui-bg: #0a0a0a;
      --border: #555;
      --border-hover: #aaa;
      --text: #fff;
      --text-dim: #ccc;
      --text-muted: #999;
      --text-faint: #777;
      --text-ghost: #555;
      --card-bg: rgba(0,0,0,0.85);
      --modal-bg: #0a0a0a;
      --modal-overlay: rgba(0,0,0,0.8);
      --kbd-bg: #222;
      --link: #666;
      --link-hover: #aaa;
      --attrib: #555;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      width: 100%; height: 100%; overflow: hidden;
      background: var(--bg);
      font-family: 'Overpass Mono', 'Courier New', monospace;
      color: var(--text);
      overscroll-behavior: none; touch-action: none;
    }
    canvas { display: block; }

    #ui-overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; user-select: none;
    }
    #ui-overlay > * { pointer-events: auto; }

    /* Loading screen */
    #loading-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      background: var(--bg); z-index: 1000;
    }
    #loading-screen .bar-outer { width: 400px; height: 30px; border: 2px solid var(--text); }
    #loading-screen .bar-inner {
      height: 100%; width: 0%; background: var(--text-dim); transition: width 0.3s;
      margin: 4px; height: calc(100% - 8px);
    }
    #loading-screen .msg { margin-bottom: 16px; font-size: 18px; color: var(--text); }

    /* Top-left panel: status line + toggles */
    #top-panel {
      position: absolute; top: 8px; left: 10px;
      display: flex; flex-direction: column; gap: 4px;
    }
    #status-line {
      font-size: 13px; color: var(--text-muted); white-space: nowrap;
    }
    #speed-line {
      font-size: 12px; color: var(--text-muted); white-space: nowrap;
    }

    /* Stats (top-right) */
    #stats-panel {
      position: absolute; top: 8px; right: 10px;
      text-align: right;
    }
    #stats-panel .fps { color: #00ff00; font-size: 14px; font-weight: bold; }
    #stats-panel .sat-count { color: var(--text-muted); font-size: 12px; margin-top: 1px; }

    #toggle-row {
      display: flex; flex-direction: column; gap: 3px;
      margin-top: 4px;
    }
    #toggle-row label {
      display: flex; align-items: center; gap: 6px;
      font-size: 13px; cursor: pointer; color: var(--text-dim);
      line-height: 18px;
    }
    #toggle-row label:hover { color: var(--text); }
    #toggle-row input[type="checkbox"] {
      appearance: none; -webkit-appearance: none;
      width: 14px; height: 14px;
      border: 2px solid var(--border-hover); background: transparent;
      cursor: pointer; position: relative; flex-shrink: 0;
    }
    #toggle-row input[type="checkbox"]:hover { border-color: var(--text); }
    #toggle-row input[type="checkbox"]:checked::after {
      content: '';
      position: absolute;
      top: 2px; left: 2px; right: 2px; bottom: 2px;
      background: var(--text);
    }
    #toggle-row input[type="checkbox"]:disabled {
      border-color: var(--text-dim); opacity: 0.4; cursor: default;
    }
    #toggle-row label:has(input:disabled) { color: var(--text-dim); opacity: 0.6; cursor: default; }

    /* Help button */
    #info-btn, #settings-btn {
      background: var(--ui-bg); border: 1px solid var(--border);
      color: var(--text-faint); font-size: 13px; font-family: inherit;
      padding: 3px 8px; cursor: pointer;
    }
    #info-btn:hover, #settings-btn:hover { border-color: var(--border-hover); color: var(--text-dim); }

    /* TLE Picker (bottom-right) */
    #tle-picker {
      position: absolute; bottom: 10px; right: 10px;
      display: flex; flex-direction: column; align-items: flex-end; gap: 6px;
    }
    #tle-main-row {
      display: flex; align-items: center; gap: 6px;
    }
    #tle-picker select, #tle-picker button, #tle-picker input[type="text"] {
      background: var(--ui-bg); color: var(--text); border: 1px solid var(--border);
      padding: 3px 6px; font-size: 13px; font-family: inherit;
      cursor: pointer;
    }
    #tle-picker select:hover, #tle-picker button:hover, #tle-picker input[type="text"]:hover {
      border-color: var(--border-hover);
    }
    #tle-custom-row { display: none; gap: 4px; align-items: center; }
    #tle-custom-row.visible { display: flex; }
    #tle-url-input { width: 220px; cursor: text; }

    /* Planet picker */
    #planet-picker-row { display: flex; justify-content: flex-end; margin-right: 16px; margin-bottom: 16px; }
    #planet-btn {
      background: none; border: none;
      width: 36px; height: 36px; padding: 0;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
    }
    #planet-btn canvas { width: 36px; height: 36px; transition: filter 0.15s; display: block; }
    #planet-btn:hover canvas { filter: brightness(1.4); }
    #planet-btn.loading { opacity: 0.5; pointer-events: none; }

    #tle-url-input::placeholder { color: var(--text-ghost); }
    #tle-file-input {
      position: absolute; width: 0; height: 0; overflow: hidden;
      opacity: 0; pointer-events: none;
    }

    /* Satellite info tooltip */
    #sat-info {
      position: absolute; display: none;
      background: var(--card-bg); padding: 8px 12px;
      font-size: 13px; line-height: 1.4;
      min-width: 200px; pointer-events: none;
      border-left: 2px solid var(--border); z-index: 10;
    }
    #sat-info .sat-name { font-size: 14px; margin-bottom: 4px; }
    #sat-info .sat-detail { color: var(--text-dim); }

    /* Apsis labels */
    .apsis-label {
      position: absolute; display: none; font-size: 12px;
      pointer-events: none; white-space: nowrap;
    }
    .apsis-label.peri { color: #87ceeb; }
    .apsis-label.apo { color: #ffa500; }

    /* Bottom-left: attribution */
    #bottom-panel {
      position: absolute; bottom: 8px; left: 10px;
      font-size: 11px; line-height: 1.4; color: var(--attrib);
    }
    #bottom-panel a { color: var(--link); text-decoration: none; pointer-events: auto; }
    #bottom-panel a:hover { color: var(--link-hover); }

    /* Info modal */
    #info-modal {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      z-index: 999; align-items: center; justify-content: center;
      background: var(--modal-overlay);
    }
    #info-modal.visible { display: flex; }
    #info-modal-content {
      background: var(--modal-bg); border: 1px solid var(--border);
      padding: 18px 22px; max-width: 420px; width: 90%;
      font-size: 13px; line-height: 1.6; color: var(--text-muted);
    }
    #info-modal-content h3 {
      font-size: 14px; color: var(--text-dim); margin-bottom: 8px; font-weight: normal;
    }
    #info-modal-content h4 {
      font-size: 12px; color: var(--link); margin-bottom: 4px; font-weight: normal;
      text-transform: uppercase; letter-spacing: 0.5px;
    }
    #info-modal-content .section { margin-bottom: 14px; }
    #info-modal-content .section:last-child { margin-bottom: 0; }
    #info-modal-content .ctrl-table {
      display: grid; grid-template-columns: auto 1fr; gap: 2px 12px;
    }
    #info-modal-content .ctrl-key { color: var(--text-dim); text-align: right; white-space: nowrap; }
    #info-modal-content .ctrl-desc { color: var(--text-muted); }
    #info-modal-content a { color: var(--text-faint); text-decoration: none; }
    #info-modal-content a:hover { color: var(--text-dim); }
    #info-modal-content kbd {
      background: var(--kbd-bg); border: 1px solid var(--border); padding: 0 4px;
      font-family: inherit; font-size: 12px; color: var(--text-dim);
    }
    .touch-controls { display: none; margin-bottom: 14px; }
    .desktop-controls { display: block; margin-bottom: 14px; }
    @media (pointer: coarse) {
      .touch-controls { display: block; }
      .desktop-controls { display: none; }
    }
    #info-modal-close {
      background: transparent; border: 1px solid var(--border);
      color: var(--text-muted); font-size: 13px; font-family: inherit;
      padding: 4px 14px; cursor: pointer; margin-top: 10px;
      float: right;
    }
    #info-modal-close:hover { border-color: var(--border-hover); color: var(--text-dim); }

    /* Settings modal */
    #settings-modal {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      z-index: 999; align-items: center; justify-content: center;
      background: var(--modal-overlay);
    }
    #settings-modal.visible { display: flex; }
    #settings-modal-content {
      background: var(--modal-bg); border: 1px solid var(--border);
      padding: 18px 22px; max-width: 320px; width: 90%;
      font-size: 13px; line-height: 1.6; color: var(--text-muted);
    }
    #settings-modal-content h3 {
      font-size: 14px; color: var(--text-dim); margin-bottom: 12px; font-weight: normal;
    }
    .settings-section {
      font-size: 11px; color: var(--text-ghost); font-weight: normal;
      text-transform: uppercase; letter-spacing: 1px;
      margin: 12px 0 8px; padding-bottom: 4px;
      border-bottom: 1px solid var(--border);
    }
    .settings-section:first-of-type { margin-top: 0; }
    .settings-row {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 10px;
    }
    .settings-row label { color: var(--text-dim); }
    .settings-row select {
      background: var(--ui-bg); color: var(--text); border: 1px solid var(--border);
      padding: 3px 6px; font-size: 13px; font-family: inherit; cursor: pointer;
    }
    .settings-row select:hover { border-color: var(--border-hover); }
    .settings-checkbox {
      appearance: none; -webkit-appearance: none;
      width: 16px; height: 16px;
      border: 2px solid var(--border-hover); background: transparent;
      cursor: pointer; position: relative;
    }
    .settings-checkbox:hover { border-color: var(--text); }
    .settings-checkbox:checked::after {
      content: ''; position: absolute;
      top: 2px; left: 2px; right: 2px; bottom: 2px;
      background: var(--text);
    }
    .settings-row-slider { flex-direction: column; align-items: stretch; gap: 4px; }
    .settings-row-slider label { display: flex; justify-content: space-between; }
    .settings-slider {
      -webkit-appearance: none; appearance: none;
      width: 100%; height: 4px; background: var(--border);
      outline: none; cursor: pointer;
    }
    .settings-slider::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 14px; height: 14px; background: var(--text-dim);
      border: none; cursor: pointer;
    }
    .settings-slider::-moz-range-thumb {
      width: 14px; height: 14px; background: var(--text-dim);
      border: none; cursor: pointer;
    }
    .settings-slider:hover::-webkit-slider-thumb { background: var(--text); }
    .settings-slider:hover::-moz-range-thumb { background: var(--text); }
    .settings-warning {
      font-size: 11px; color: #cc6633; margin: -6px 0 8px;
    }
    .info-tip {
      cursor: help; color: var(--text-ghost); font-size: 11px; position: relative;
      margin-left: 4px;
    }
    .info-tip:hover { color: var(--text-dim); }
    .info-tip-content {
      display: none;
      position: absolute; bottom: calc(100% + 6px); right: -12px;
      background: #111; border: 1px solid var(--border);
      color: var(--text-dim); font-size: 11px;
      padding: 10px 12px;
      width: 320px; pointer-events: none; z-index: 10;
      line-height: 1.6; font-weight: normal;
      border-radius: 3px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    }
    .info-tip:hover .info-tip-content { display: block; }
    .info-tip-content b { color: var(--text); font-weight: 600; }
    .info-tip-content .tip-options {
      margin-top: 6px; padding-top: 6px;
      border-top: 1px solid var(--border);
    }
    .info-tip-content .tip-options div {
      padding: 2px 0;
    }
    .info-tip-content .tip-options + * {
      margin-top: 6px; padding-top: 6px;
      border-top: 1px solid var(--border);
    }
    #settings-modal-close {
      background: transparent; border: 1px solid var(--border);
      color: var(--text-muted); font-size: 13px; font-family: inherit;
      padding: 4px 14px; cursor: pointer; margin-top: 6px;
      float: right;
    }
    #settings-modal-close:hover { border-color: var(--border-hover); color: var(--text-dim); }

    /* Mobile */
    @media (max-width: 600px) {
      #status-line { font-size: 11px; }
      #toggle-row label { font-size: 12px; }
      #toggle-row input[type="checkbox"] { width: 20px; height: 20px; }
      #toggle-row { gap: 6px; }
      #sat-info { font-size: 12px; min-width: 170px; }
      #sat-info .sat-name { font-size: 13px; }
      #tle-picker select, #tle-picker button, #tle-picker input[type="text"] {
        font-size: 13px; padding: 5px 8px;
      }
      #tle-url-input { width: 130px; }
      #tle-custom-row { flex-wrap: wrap; justify-content: flex-end; }
      #bottom-panel { display: none; }
      #info-btn {
        position: fixed; bottom: 10px; left: 10px;
        padding: 5px 10px; font-size: 15px;
      }
      #loading-screen .bar-outer { width: 80%; max-width: 280px; height: 22px; }
      #loading-screen .msg { font-size: 15px; }
    }
  </style>
</head>
<body>
  <div id="loading-screen">
    <div class="msg" id="loading-msg">Initializing...</div>
    <div class="bar-outer"><div class="bar-inner" id="loading-bar"></div></div>
  </div>

  <div id="info-modal">
    <div id="info-modal-content">
      <div class="touch-controls">
        <div class="section">
          <h3>Touch</h3>
          <div class="ctrl-table">
            <span class="ctrl-key">1 finger drag</span><span class="ctrl-desc">Orbit camera</span>
            <span class="ctrl-key">2 finger drag</span><span class="ctrl-desc">Pan camera</span>
            <span class="ctrl-key">Pinch</span><span class="ctrl-desc">Zoom in / out</span>
            <span class="ctrl-key">Tap satellite</span><span class="ctrl-desc">Select / deselect</span>
          </div>
        </div>
      </div>
      <div class="desktop-controls">
        <div class="section">
          <h3>Mouse</h3>
          <div class="ctrl-table">
            <span class="ctrl-key"><kbd>RMB</kbd> drag</span><span class="ctrl-desc">Orbit camera</span>
            <span class="ctrl-key"><kbd>Shift</kbd>+<kbd>RMB</kbd> drag</span><span class="ctrl-desc">Pan camera</span>
            <span class="ctrl-key"><kbd>Scroll</kbd></span><span class="ctrl-desc">Zoom in / out</span>
            <span class="ctrl-key">Click satellite</span><span class="ctrl-desc">Select / deselect</span>
          </div>
        </div>
        <div class="section">
          <h3>Keyboard</h3>
          <div class="ctrl-table">
            <span class="ctrl-key"><kbd>Space</kbd></span><span class="ctrl-desc">Pause / resume</span>
            <span class="ctrl-key"><kbd>.</kbd> <kbd>,</kbd></span><span class="ctrl-desc">Speed up / slow down</span>
            <span class="ctrl-key"><kbd>/</kbd></span><span class="ctrl-desc">Reset speed</span>
            <span class="ctrl-key"><kbd>M</kbd></span><span class="ctrl-desc">Toggle 2D / 3D map</span>
          </div>
        </div>
      </div>
      <div class="section">
        <h3>About</h3>
        TLE data from <a href="https://celestrak.org" target="_blank">CelesTrak</a><br>
        Based on <a href="https://github.com/aweeri/TLEscope" target="_blank">TLEscope</a> by aweeri<br>
        <a href="https://github.com/aweeri/TLEscope/blob/main/LICENSE" target="_blank">AGPL-3.0</a>
        &middot; <a href="https://github.com/sandrwich/threescope" target="_blank">Source code</a>
      </div>
      <button id="info-modal-close">Close</button>
    </div>
  </div>

  <div id="settings-modal">
    <div id="settings-modal-content">
      <h3>Settings</h3>
      <h4 class="settings-section">Graphics</h4>
      <div class="settings-row">
        <label>Preset</label>
        <select id="gfx-preset-select">
          <option value="standard">Standard</option>
          <option value="rtx" selected>RTX</option>
          <option value="custom" disabled hidden>Custom</option>
        </select>
      </div>
      <div class="settings-row">
        <label>
          Bloom
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              UnrealBloomPass post-processing. Samples bright fragments and
              applies a Gaussian blur to simulate light bleeding — visible on
              the sun disc, city lights, and atmosphere rim.
            </span>
          </span>
        </label>
        <input type="checkbox" id="gfx-bloom" class="settings-checkbox" checked>
      </div>
      <div class="settings-row">
        <label>
          Atmosphere Glow
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Additive rim-glow shell around Earth. Uses a Fresnel-based
              fragment shader on a slightly oversized sphere — fragments facing
              the camera get more glow. Only visible when bloom is enabled.
            </span>
          </span>
        </label>
        <input type="checkbox" id="gfx-atmosphere" class="settings-checkbox" checked>
      </div>
      <div class="settings-row">
        <label>
          Bump Mapping
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Perturbs surface normals in the fragment shader using a height
              map. Adds visible terrain detail (mountains, craters) to Earth,
              Moon, and planets without increasing vertex count. Uses 4
              neighboring texel samples to estimate the local gradient.
            </span>
          </span>
        </label>
        <input type="checkbox" id="gfx-bump" class="settings-checkbox" checked>
      </div>
      <div class="settings-row">
        <label>
          Curvature AO
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Curvature-based ambient occlusion. Computes a Laplacian from 4
              height map neighbors vs. the center texel — concave areas (crater
              floors, valleys) get darkened, adding depth without a separate AO
              pass.
            </span>
          </span>
        </label>
        <input type="checkbox" id="gfx-ao" class="settings-checkbox" checked>
      </div>
      <div class="settings-row">
        <label>
          Sphere Detail
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Latitude × longitude subdivisions for planet sphere meshes.
              Higher counts give vertex displacement maps more geometry to
              deform.
              <div class="tip-options">
                <div><b>Low</b> (32×32) — 2k tris, fast</div>
                <div><b>Medium</b> (64×64) — 8k tris</div>
                <div><b>High</b> (128×128) — 33k tris</div>
                <div><b>Very High</b> (256×256) — 131k tris</div>
                <div><b>Ultra</b> (512×512) — 524k tris, sharpest relief</div>
              </div>
            </span>
          </span>
        </label>
        <select id="gfx-sphere-detail">
          <option value="32">Low</option>
          <option value="64">Medium</option>
          <option value="128">High</option>
          <option value="256">Very High</option>
          <option value="512" selected>Ultra</option>
        </select>
      </div>
      <div class="settings-row settings-row-slider">
        <label>Surface Relief <span id="relief-value">4.0x</span></label>
        <input type="range" id="relief-slider" min="0" max="100" value="40" class="settings-slider">
      </div>

      <h4 class="settings-section">Simulation</h4>
      <div class="settings-row">
        <label>Preset</label>
        <select id="sim-preset-select">
          <option value="approximate">Approximate</option>
          <option value="accurate" selected>Accurate</option>
          <option value="custom" disabled hidden>Custom</option>
        </select>
      </div>
      <div class="settings-row">
        <label>
          Orbit Mode
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              How background orbit paths are computed.
              <div class="tip-options">
                <div>
                  <b>Analytical</b> — Keplerian ellipse from TLE orbital
                  elements (a, e, i, Ω, ω). Shape computed once at load;
                  orientation updated with optional J2 secular corrections.
                  Fast even with 10k+ satellites.
                </div>
                <div>
                  <b>SGP4</b> — full SGP4/SDP4 numerical propagation for
                  every satellite. Includes J2–J4, drag, lunar/solar
                  perturbations. Most accurate but O(n × segments)
                  propagation calls on every recompute.
                </div>
              </div>
            </span>
          </span>
        </label>
        <select id="sim-orbit-mode">
          <option value="analytical">Analytical</option>
          <option value="sgp4" selected>SGP4</option>
        </select>
      </div>
      <div class="settings-row">
        <label>
          Orbit Segments
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Number of line segments per orbit ellipse. Each segment is a
              pair of vertices connected by GL_LINES.
              <div class="tip-options">
                <div><b>Low</b> (16) — visibly polygonal, lightest</div>
                <div><b>Medium</b> (30) — good balance for large datasets</div>
                <div><b>High</b> (60) — smooth curves</div>
                <div><b>Ultra</b> (90) — near-continuous, heaviest</div>
              </div>
            </span>
          </span>
        </label>
        <select id="sim-orbit-segments">
          <option value="16">Low</option>
          <option value="30">Medium</option>
          <option value="60">High</option>
          <option value="90" selected>Ultra</option>
        </select>
      </div>
      <div class="settings-row" id="sim-j2-row">
        <label>
          J2 Precession
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Applies J2 secular perturbation to orbit orientation. Earth's
              oblateness causes RAAN to regress and argument of perigee to
              advance — about 5°/day for typical LEO orbits.
              <div class="tip-options">
                <div><b>On</b> — Ω(t) = Ω₀ + Ω̇·Δt, ω(t) = ω₀ + ω̇·Δt</div>
                <div><b>Off</b> — orbits stay frozen at TLE epoch angles</div>
              </div>
            </span>
          </span>
        </label>
        <input type="checkbox" id="sim-j2" class="settings-checkbox" checked>
      </div>
      <div class="settings-row" id="sim-drag-row">
        <label>
          Atmospheric Drag
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Uses the TLE first derivative of mean motion (ṅ, ndot) to model
              orbital decay. Every 6 hours of sim-time, semi-major axis is
              recomputed: a(t) = (μ / n(t)²)^⅓ where n(t) = n₀ + ṅ·Δt.
              Perifocal vertices are rebuilt if any satellite's a drifts
              &gt;0.1 km.
              <div class="tip-options">
                <div><b>On</b> — LEO orbits gradually shrink</div>
                <div><b>Off</b> — orbits keep their original size</div>
              </div>
            </span>
          </span>
        </label>
        <input type="checkbox" id="sim-drag" class="settings-checkbox" checked>
      </div>
      <div class="settings-row">
        <label>
          Update Quality
          <span class="info-tip">ⓘ
            <span class="info-tip-content">
              Satellites are divided into N batches. Each frame, one batch
              gets a full SGP4 position update. N adapts to time warp: at
              high warp, more batches run per frame automatically.
              <div class="tip-options">
                <div><b>Ultra</b> — every satellite updated every frame, zero staleness</div>
                <div><b>High</b> — LEO ≈ 1 km max error</div>
                <div><b>Balanced</b> — LEO ≈ 2 km max error</div>
                <div><b>Low</b> — LEO ≈ 4 km max error</div>
                <div><b>Lowest</b> — LEO ≈ 8 km max error</div>
              </div>
              <div>
                Errors for LEO at ~550 km altitude (~7.6 km/s), 1× speed,
                60 FPS. Scales linearly with frame rate — at 30 FPS errors
                double. Higher orbits are slower and have proportionally
                less error.
              </div>
            </span>
          </span>
        </label>
        <select id="update-quality-select">
          <option value="1">Ultra</option>
          <option value="8" selected>High</option>
          <option value="16">Balanced</option>
          <option value="32">Low</option>
          <option value="64">Lowest</option>
        </select>
      </div>
      <h4 class="settings-section">General</h4>
      <div class="settings-row settings-row-slider">
        <label>FPS Limit <span id="fps-limit-value">Vsync</span></label>
        <input type="range" id="fps-limit-slider" min="0" max="482" value="0" class="settings-slider">
      </div>
      <div id="fps-limit-warning" class="settings-warning" style="display:none">May reduce UI responsiveness</div>
      <button id="settings-modal-close">Close</button>
    </div>
  </div>

  <div id="ui-overlay">
    <div id="top-panel">
      <div id="status-line"></div>
      <div id="speed-line"></div>
      <div id="toggle-row">
        <label id="rtx-label" title="Toggle RTX graphics preset"><input type="checkbox" id="cb-rtx" checked> RTX</label>
        <span id="earth-toggles" style="display:contents">
          <label title="Hide all satellites except selected"><input type="checkbox" id="cb-hide-unselected" checked> Spotlight</label>
          <label title="Show cloud layer on Earth"><input type="checkbox" id="cb-clouds"> Clouds</label>
          <label title="Show launch site markers"><input type="checkbox" id="cb-markers"> Markers</label>
        </span>
        <span id="night-toggle" style="display:contents">
          <label title="Show city lights on night side"><input type="checkbox" id="cb-night-lights" checked> Night</label>
        </span>
      </div>
    </div>
    <div id="stats-panel">
      <div class="fps" id="fps-display">-- FPS</div>
      <div class="sat-count" id="sat-count-display"></div>
    </div>
    <div id="tle-picker">
      <div id="planet-picker-row">
        <button id="planet-btn" title="Solar System Explorer">
          <canvas id="planet-btn-canvas" width="56" height="56"></canvas>
        </button>
      </div>
      <div id="tle-main-row">
        <button id="settings-btn" title="Settings">&#9881;</button>
        <button id="info-btn">?</button>
        <select id="tle-select"></select>
      </div>
      <div id="tle-custom-row">
        <input type="text" id="tle-url-input" placeholder="TLE URL...">
        <button id="tle-url-btn">Load</button>
        <button id="tle-file-btn">File</button>
        <input type="file" id="tle-file-input" accept=".tle,.txt,.3le">
      </div>
    </div>
    <div id="sat-info">
      <div class="sat-name" id="sat-info-name"></div>
      <div class="sat-detail" id="sat-info-detail"></div>
    </div>
    <div class="apsis-label peri" id="peri-label"></div>
    <div class="apsis-label apo" id="apo-label"></div>
    <div id="bottom-panel">
      <div>
        TLE data from <a href="https://celestrak.org" target="_blank">CelesTrak</a><br>
        Based on <a href="https://github.com/aweeri/TLEscope" target="_blank">TLEscope</a> by aweeri
        &middot; <a href="https://github.com/aweeri/TLEscope/blob/main/LICENSE" target="_blank">AGPL-3.0</a>
        &middot; <a href="https://github.com/sandrwich/threescope" target="_blank">Source code</a>
      </div>
    </div>
  </div>

  <script type="module" src="/src/main.ts"></script>
</body>
</html>
